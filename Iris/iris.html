<html>
<head>

<link rel="stylesheet" href="iris.css" type="text/css" media="screen" title="main" charset="utf-8">
<link rel="stylesheet" href="valums-file-uploader-b3b20b1/client/fileuploader.css" type="text/css" media="screen" title="main" charset="utf-8">

<script src="valums-file-uploader-b3b20b1/client/fileuploader.js" type="text/javascript" charset="utf-8"></script>
<script src="json2.js" type="text/javascript" charset="utf-8"></script>
<!--<script src="jquery-1.7.2.js" type="text/javascript" charset="utf-8"></script>-->
<script src="mootools.js" type="text/javascript" charset="utf-8"></script>
<script src="../lib/InvocationService.js" type="text/javascript" charset="utf-8"></script>
<script src="iris.js" type="text/javascript" charset="utf-8"></script>

        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
        <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.0/jquery-ui.min.js"></script>


        <link type = 'text/css' href = 'http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.0/themes/smoothness/jquery-ui.css' rel = 'stylesheet' />

        <script src = 'http://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.2/jquery.cookie.js'></script>
        <script src="./jquery.kbase.widget.js"></script>
        <script src="./jquery.kbase.login.js"></script>


        <script type = 'text/javascript'>
            <!--
                $(function() {

					window.$ld = $("<div></div>").login(
						{
							style : 'hidden',
							login_callback : function(args) {
								if (args.success) {
									var commandDiv = new Element('div');
									window.terminal.terminal.grab(commandDiv);
									window.terminal.out_line();
									window.terminal.scroll();
									window.terminal.client.start_session_async(args.user_id,
										function (newsid) {
											window.terminal.set_session(args.user_id);
											window.terminal.commandHistory.load(window.terminal.client, args.user_id);
											window.terminal.out_to_div(commandDiv, "Set session to " + args.user_id);
										}.bind(window.terminal),
										function (err) {
											window.terminal.out_to_div(commandDiv, "<i>Error on session_start:<br>" +
												err.message.replace("\n", "<br>\n") + "</i>");
										}.bind(window.terminal)
									);

									window.terminal.client.kbase_sessionid = args.kbase_sessionid;
									$('#input_box').focus();
								}
							}
						}
					);

                    var cookie;
                    if (cookie = window.$ld.login('get_kbase_cookie')) {
                        var commandDiv = new Element('div');
                        window.terminal.terminal.grab(commandDiv);
                        window.terminal.out_line();
                        window.terminal.scroll();
                        window.terminal.out_to_div(commandDiv, 'Already logged in as ' + cookie.fullname);
                        window.terminal.set_session(cookie.user_id);
                        window.terminal.commandHistory.load(window.terminal.client, cookie.user_id);
                        window.terminal.out_to_div(commandDiv, "Set session to " + cookie.user_id);
                        
                    }
				});

            //-->
        </script>

</head>
<body>
  <div id="wrapper">
    <div id="main">
      <div id="pageheader">
	KBase Interaction
	<div id="file-uploader">
	</div>

      </div>

      <div id="content">
	<div id="terminal">
	</div>
      </div>
    </div>
    <div id="footer">
      <textarea id="input_box" width="90%" height="90%"></textarea>
    </div>

</body>

</html>
